# C TCP 客户端

这是用 C 语言重写的 TCP 客户端，相比 Python 和 Go 版本具有以下优势：
- **最小的文件大小**：编译后的可执行文件通常只有几十KB
- **最快的运行速度**：C 语言编译的原生代码执行效率最高
- **最少的依赖**：只依赖系统库，无需额外运行时环境
- **最低的内存占用**：运行时内存消耗最小

## 编译环境要求

### Windows
- **MinGW-w64**（推荐）或其他 GCC 发行版
- 下载地址：https://www.mingw-w64.org/downloads/
- 或者使用 MSYS2：https://www.msys2.org/

### 安装 MinGW-w64 简易步骤
1. 下载 MinGW-w64 安装包
2. 安装到默认路径（如 `C:\mingw64`）
3. 将 `C:\mingw64\bin` 添加到系统 PATH 环境变量
4. 重启命令提示符，输入 `gcc --version` 验证安装

## 编译方法

### 方法1：使用批处理文件（推荐）
```bash
build_c.bat
```

### 方法2：使用 Makefile（需要 make 工具）
```bash
make
# 或者
make all
```

### 方法3：手动编译
```bash
gcc -Wall -Wextra -O2 -s -o client.exe client.c -lws2_32
```

## 编译选项说明

- `-Wall -Wextra`：启用所有警告，确保代码质量
- `-O2`：优化级别2，平衡编译时间和运行效率
- `-s`：去除调试信息，减小文件大小
- `-lws2_32`：链接 Windows Socket 库

## 使用方法

编译成功后，会生成 `client.exe` 文件。使用方法如下：

```bash
# 使用默认参数（IP: 10.63.81.34, 端口: 9999）
client.exe

# 指定 IP 地址
client.exe -i 192.168.1.100

# 指定端口
client.exe -p 8888

# 同时指定 IP 和端口
client.exe -i 101.201.56.60 -p 8090

# 查看帮助信息
client.exe -h
```

## 功能特性

- 支持命令行参数指定服务器 IP 和端口
- 自动重连机制：连接失败时每5秒重试一次
- 读取 `file.txt` 文件内容并发送给服务器
- 接收服务器回显的数据
- 每5秒发送一次消息
- 完整的错误处理和异常恢复
- 5秒连接超时设置

## 文件说明

- `client.c` - C 源代码文件
- `Makefile` - Make 构建文件
- `build_c.bat` - Windows 批处理编译脚本
- `file.txt` - 要发送的数据文件
- `client.exe` - 编译后的可执行文件（编译后生成）

## 性能对比

| 语言 | 文件大小 | 启动速度 | 内存占用 | 编译复杂度 |
|------|----------|----------|----------|------------|
| Python (打包) | ~20-50MB | 慢 | 高 | 简单 |
| Go | ~2-8MB | 快 | 中等 | 简单 |
| **C** | **~50-200KB** | **最快** | **最低** | 中等 |

## 故障排除

### 编译错误
1. **找不到 gcc**：确保已安装 MinGW-w64 并添加到 PATH
2. **链接错误**：确保使用了 `-lws2_32` 参数
3. **头文件错误**：确保使用的是 MinGW-w64 而不是旧版本的 MinGW

### 运行错误
1. **找不到 file.txt**：确保 `file.txt` 文件在可执行文件同一目录
2. **连接失败**：检查服务器 IP 和端口是否正确
3. **权限错误**：以管理员身份运行或检查防火墙设置

## 系统要求

- Windows 7 或更高版本
- 编译时需要 GCC 编译器
- 运行时无需额外依赖